/raid/home/automathon_2024/account6/.local/lib/python3.10/site-packages/torch/cuda/__init__.py:118: UserWarning: CUDA initialization: CUDA unknown error - this may be due to an incorrectly set up environment, e.g. changing env variable CUDA_VISIBLE_DEVICES after program start. Setting the available devices to be zero. (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
  return torch._C._cuda_getDeviceCount() > 0
Training model:
  0%|                                                                                                                                                   | 0/310 [00:00<?, ?it/s]
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
DeepfakeDetector                         [32, 2]                   --
├─VGG: 1-1                               --                        123,642,856
│    └─Sequential: 2-1                   [32, 512, 7, 7]           --
│    │    └─Conv2d: 3-1                  [32, 64, 224, 224]        (1,792)
│    │    └─BatchNorm2d: 3-2             [32, 64, 224, 224]        (128)
│    │    └─ReLU: 3-3                    [32, 64, 224, 224]        --
│    │    └─Conv2d: 3-4                  [32, 64, 224, 224]        (36,928)
│    │    └─BatchNorm2d: 3-5             [32, 64, 224, 224]        (128)
│    │    └─ReLU: 3-6                    [32, 64, 224, 224]        --
│    │    └─MaxPool2d: 3-7               [32, 64, 112, 112]        --
│    │    └─Conv2d: 3-8                  [32, 128, 112, 112]       (73,856)
│    │    └─BatchNorm2d: 3-9             [32, 128, 112, 112]       (256)
│    │    └─ReLU: 3-10                   [32, 128, 112, 112]       --
│    │    └─Conv2d: 3-11                 [32, 128, 112, 112]       (147,584)
│    │    └─BatchNorm2d: 3-12            [32, 128, 112, 112]       (256)
│    │    └─ReLU: 3-13                   [32, 128, 112, 112]       --
│    │    └─MaxPool2d: 3-14              [32, 128, 56, 56]         --
│    │    └─Conv2d: 3-15                 [32, 256, 56, 56]         (295,168)
│    │    └─BatchNorm2d: 3-16            [32, 256, 56, 56]         (512)
│    │    └─ReLU: 3-17                   [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-18                 [32, 256, 56, 56]         (590,080)
│    │    └─BatchNorm2d: 3-19            [32, 256, 56, 56]         (512)
│    │    └─ReLU: 3-20                   [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-21                 [32, 256, 56, 56]         (590,080)
│    │    └─BatchNorm2d: 3-22            [32, 256, 56, 56]         (512)
│    │    └─ReLU: 3-23                   [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-24                 [32, 256, 56, 56]         (590,080)
│    │    └─BatchNorm2d: 3-25            [32, 256, 56, 56]         (512)
│    │    └─ReLU: 3-26                   [32, 256, 56, 56]         --
│    │    └─MaxPool2d: 3-27              [32, 256, 28, 28]         --
│    │    └─Conv2d: 3-28                 [32, 512, 28, 28]         (1,180,160)
│    │    └─BatchNorm2d: 3-29            [32, 512, 28, 28]         (1,024)
│    │    └─ReLU: 3-30                   [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-31                 [32, 512, 28, 28]         (2,359,808)
│    │    └─BatchNorm2d: 3-32            [32, 512, 28, 28]         (1,024)
│    │    └─ReLU: 3-33                   [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-34                 [32, 512, 28, 28]         (2,359,808)
│    │    └─BatchNorm2d: 3-35            [32, 512, 28, 28]         (1,024)
│    │    └─ReLU: 3-36                   [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-37                 [32, 512, 28, 28]         (2,359,808)
│    │    └─BatchNorm2d: 3-38            [32, 512, 28, 28]         (1,024)
│    │    └─ReLU: 3-39                   [32, 512, 28, 28]         --
│    │    └─MaxPool2d: 3-40              [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-41                 [32, 512, 14, 14]         (2,359,808)
│    │    └─BatchNorm2d: 3-42            [32, 512, 14, 14]         (1,024)
│    │    └─ReLU: 3-43                   [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-44                 [32, 512, 14, 14]         (2,359,808)
│    │    └─BatchNorm2d: 3-45            [32, 512, 14, 14]         (1,024)
│    │    └─ReLU: 3-46                   [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-47                 [32, 512, 14, 14]         (2,359,808)
│    │    └─BatchNorm2d: 3-48            [32, 512, 14, 14]         (1,024)
│    │    └─ReLU: 3-49                   [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-50                 [32, 512, 14, 14]         (2,359,808)
│    │    └─BatchNorm2d: 3-51            [32, 512, 14, 14]         (1,024)
│    │    └─ReLU: 3-52                   [32, 512, 14, 14]         --
│    │    └─MaxPool2d: 3-53              [32, 512, 7, 7]           --
│    └─Sequential: 2-2                   [32, 512, 7, 7]           (recursive)
│    │    └─Conv2d: 3-54                 [32, 64, 224, 224]        (recursive)
│    │    └─BatchNorm2d: 3-55            [32, 64, 224, 224]        (recursive)
│    │    └─ReLU: 3-56                   [32, 64, 224, 224]        --
│    │    └─Conv2d: 3-57                 [32, 64, 224, 224]        (recursive)
│    │    └─BatchNorm2d: 3-58            [32, 64, 224, 224]        (recursive)
│    │    └─ReLU: 3-59                   [32, 64, 224, 224]        --
│    │    └─MaxPool2d: 3-60              [32, 64, 112, 112]        --
│    │    └─Conv2d: 3-61                 [32, 128, 112, 112]       (recursive)
│    │    └─BatchNorm2d: 3-62            [32, 128, 112, 112]       (recursive)
│    │    └─ReLU: 3-63                   [32, 128, 112, 112]       --
│    │    └─Conv2d: 3-64                 [32, 128, 112, 112]       (recursive)
│    │    └─BatchNorm2d: 3-65            [32, 128, 112, 112]       (recursive)
│    │    └─ReLU: 3-66                   [32, 128, 112, 112]       --
│    │    └─MaxPool2d: 3-67              [32, 128, 56, 56]         --
│    │    └─Conv2d: 3-68                 [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-69            [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-70                   [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-71                 [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-72            [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-73                   [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-74                 [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-75            [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-76                   [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-77                 [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-78            [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-79                   [32, 256, 56, 56]         --
│    │    └─MaxPool2d: 3-80              [32, 256, 28, 28]         --
│    │    └─Conv2d: 3-81                 [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-82            [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-83                   [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-84                 [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-85            [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-86                   [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-87                 [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-88            [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-89                   [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-90                 [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-91            [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-92                   [32, 512, 28, 28]         --
│    │    └─MaxPool2d: 3-93              [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-94                 [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-95            [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-96                   [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-97                 [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-98            [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-99                   [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-100                [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-101           [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-102                  [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-103                [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-104           [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-105                  [32, 512, 14, 14]         --
│    │    └─MaxPool2d: 3-106             [32, 512, 7, 7]           --
│    └─Sequential: 2-3                   [32, 512, 7, 7]           (recursive)
│    │    └─Conv2d: 3-107                [32, 64, 224, 224]        (recursive)
│    │    └─BatchNorm2d: 3-108           [32, 64, 224, 224]        (recursive)
│    │    └─ReLU: 3-109                  [32, 64, 224, 224]        --
│    │    └─Conv2d: 3-110                [32, 64, 224, 224]        (recursive)
│    │    └─BatchNorm2d: 3-111           [32, 64, 224, 224]        (recursive)
│    │    └─ReLU: 3-112                  [32, 64, 224, 224]        --
│    │    └─MaxPool2d: 3-113             [32, 64, 112, 112]        --
│    │    └─Conv2d: 3-114                [32, 128, 112, 112]       (recursive)
│    │    └─BatchNorm2d: 3-115           [32, 128, 112, 112]       (recursive)
│    │    └─ReLU: 3-116                  [32, 128, 112, 112]       --
│    │    └─Conv2d: 3-117                [32, 128, 112, 112]       (recursive)
│    │    └─BatchNorm2d: 3-118           [32, 128, 112, 112]       (recursive)
│    │    └─ReLU: 3-119                  [32, 128, 112, 112]       --
│    │    └─MaxPool2d: 3-120             [32, 128, 56, 56]         --
│    │    └─Conv2d: 3-121                [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-122           [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-123                  [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-124                [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-125           [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-126                  [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-127                [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-128           [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-129                  [32, 256, 56, 56]         --
│    │    └─Conv2d: 3-130                [32, 256, 56, 56]         (recursive)
│    │    └─BatchNorm2d: 3-131           [32, 256, 56, 56]         (recursive)
│    │    └─ReLU: 3-132                  [32, 256, 56, 56]         --
│    │    └─MaxPool2d: 3-133             [32, 256, 28, 28]         --
│    │    └─Conv2d: 3-134                [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-135           [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-136                  [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-137                [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-138           [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-139                  [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-140                [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-141           [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-142                  [32, 512, 28, 28]         --
│    │    └─Conv2d: 3-143                [32, 512, 28, 28]         (recursive)
│    │    └─BatchNorm2d: 3-144           [32, 512, 28, 28]         (recursive)
│    │    └─ReLU: 3-145                  [32, 512, 28, 28]         --
│    │    └─MaxPool2d: 3-146             [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-147                [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-148           [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-149                  [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-150                [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-151           [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-152                  [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-153                [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-154           [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-155                  [32, 512, 14, 14]         --
│    │    └─Conv2d: 3-156                [32, 512, 14, 14]         (recursive)
│    │    └─BatchNorm2d: 3-157           [32, 512, 14, 14]         (recursive)
│    │    └─ReLU: 3-158                  [32, 512, 14, 14]         --
│    │    └─MaxPool2d: 3-159             [32, 512, 7, 7]           --
├─LSTM: 1-2                              [32, 3, 256]              25,954,304
├─Linear: 1-3                            [32, 512]                 393,728
├─ReLU: 1-4                              [32, 512]                 --
├─Linear: 1-5                            [32, 128]                 65,664
├─ReLU: 1-6                              [32, 128]                 --
├─Linear: 1-7                            [32, 2]                   258
├─ReLU: 1-8                              [32, 2]                   --
├─Softmax: 1-9                           [32, 2]                   --
==========================================================================================
Total params: 170,092,202
Trainable params: 26,413,954
Non-trainable params: 143,678,248
Total mult-adds (T): 1.88
==========================================================================================
Input size (MB): 75.50
Forward/backward pass size (MB): 22813.18
Params size (MB): 185.80
Estimated Total Size (MB): 23074.48
==========================================================================================
Training...
0
  0%|                                                                                                                                                   | 0/310 [01:08<?, ?it/s]
Traceback (most recent call last):
  File "/raid/home/automathon_2024/account6/automathon-2024/run.py", line 302, in <module>
    label_pred = model(X)
  File "/raid/home/automathon_2024/account6/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/automathon_2024/account6/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/automathon_2024/account6/automathon-2024/run.py", line 266, in forward
    y = self.relu(self.dense1(lstm_output))
  File "/raid/home/automathon_2024/account6/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/raid/home/automathon_2024/account6/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/raid/home/automathon_2024/account6/.local/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (32x2560 and 768x512)